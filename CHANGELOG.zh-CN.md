# Changelog

这个项目的所有显著变化都将被记录在这个文件中。


## [0.12.0] -2018-12-12

### 新增

- 新增token管理功能
- 新增系统公告可执行程序
- 添加清理permission表旧数据和role_permission脏数据的开关
- 新增重置密码密码校验及删除用户下token的逻辑
- 新增用户信息的国际电话区号字段

### 移除

- 移除hystrix-stream依赖
- 移除Kafka依赖及相关配置

## [0.11.0] -2018-11-13

### 新增

- 新增单元测试
- 新增系统设置功能
- 新增发送通知服务接口
- 新增注册组织
- 角色分配接口可为客户端分配角色
- 新增`bookmark`功能
- 添加停止ldap同步的接口

### 修复

- 修复ldap无法连接和同步ad目录的问题
- 修复oracle初始化报错问题

### 修改
- 监听服务启动的方式由`kafka`改为`eureka-event`
- 站内信发送用户改为未被禁用用户
- 修改ci文件
- 更新基础镜像

## [0.10.0] -2018-09-27

### 新增

- 支持oracle数据库
- @Permission注解添加是否为内部接口的标识
- 新增仪表盘我的组织接口
- 添加ldap同步用户定时任务
- 添加站内信功能
- ldap同步禁用离职用户

### 修改

- 更新license 
- 修改了ci文件
- 更新了基础镜像

### 修复

- 修复查询组织项目数目不正确的问题
- 修复导入用户上传文件异常的问题
- 修复同步ldap用户is_admin为空的bug

## [0.8.0] - 2018-07-18

### 修改

- 升级了chart中dbtool的版本为0.5.4。
- 优化了密码策略逻辑

### 新增

- 查询项目下的用户添加按邮箱模糊查询
- 个人中心新增查询用户被分配的组织和项目功能
- 角色分配新增按角色视图模糊查询
- 组织管理新增组织下的项目字段
- 添加wiki相关label和角色,及相关业务逻辑
- 停/启用组织或项目发事件

### 修复

- 修复密码策略无法更新bug
- 修复用户管理无法模糊查询用户的bug
- 修复初始化权限时可能报字段重复的问题

## [0.7.0] - 2018-06-22

### 修改

- 升级了chart中dbtool的版本为0.5.2。
- 升级choerodon-starter依赖版本为0.5.3.RELEASE。
- 将菜单和权限的关联方式由原来的id关联，修改为code关联。

### 新增

- client客户端表新增`localhost`客户端。
- 添加菜单重名校验接口。
- 解析权限新增根据@Permission注解的roles的code值建立role_permission的关系。
- 修改调用`file-service`的feign接口。
- 修改头像返回相对地址。
- 根据层级,服务名，code查询permission列表。

### 修复

- 修复头像无法显示的问题。
- 修复了快码接口。
- 修复根据角色id查权限会出现脏数据的问题。

### 移除
- 删除icon相关的表和接口。

## [0.6.0] - 2018-06-08

### 新增

- 组织层级校验`code`
- 角色分配和用户启用禁用发送事件，添加用户`id`字段
- 用户添加管理员字段，并添加设置管理员相关操作
- 管理员用户鉴权放行处理
- 添加根据用户`id`数组查询用户接口
- 添加个人中心修改密码和编辑信息功能
- 添加`ldap`同步的历史记录
- 添加`ldap`测试连接，测试登陆，属性匹配功能
- `ldap`同步支持匿名用户同步
- 添加了`ldap`启用禁用接口

### 修改
- 角色选权限的时候，不显示`loginAccess`和`publicAccess`接口
- 角色更新时，内置角色只可以修改`label`
- 优化了所有重名校验接口的逻辑
- 将`do`,`dto`,`entity`中所有`isEnabled`之类的字段修改为`enabled`字段，防止部分框架序列化异常
- 角色分配查询角色时关联多语言表
- 左侧菜单和菜单管理将之前用一个借口实现拆分为两个接口实现
- 根据`gateway`鉴权规则，修改所有不合规范的`url`
- 优化角色分配部分循环查询的代码
- 优化用户相关`DTO`
- ldap同步用户支持可配置方式同步
- 优化了接口的描述信息

### 修复

- 修复了客户端额外信息为空，无法保存的问题
- 修复了左侧菜单只能获取两层，无法获取三层菜单的问题
- 修复了角色打标签发事件，可能会导致标签不能全部发过去的问题
- 修复项目创建时，前端检验`code`不重复，但保存时报`code`重复的问题
- 修复了角色分配页面，可能查询出空用户的问题
- 修复了角色分配时，在新建界面给某用户添加角色会导致`gitlab`角色消失的问题
- 修复了角色编辑部分角色`name`显示为英文的问题

### 移除
- 移除了`RoleController`和`UserController`里面不符合`gateway`鉴权规则的角色分配相关的接口
- 模糊查询移除按多个参数查询的功能
